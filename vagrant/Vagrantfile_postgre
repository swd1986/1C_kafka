Vagrant.configure("2") do |config|
	config.vm.define "postgre" do |vm2|
		vm2.vm.box = "eurolinux-vagrant/oracle-linux-8"
		vm2.vm.network "private_network", ip: "192.168.56.115"
		vm2.vm.hostname = "linuxpg"
		
		vm2.vm.provision "shell", inline: <<-SHELL
			# Install required packages
			sudo yum install -y glibc-common glibc-locale-source glibc-langpack-ru

			# Generate the ru_RU.UTF-8 locale
			sudo localedef -v -c -i ru_RU -f UTF-8 ru_RU.UTF-8

			# Verify the locale generation
			locale -a | grep ru_RU

			# Set the locale as default
			echo 'LANG="ru_RU.UTF-8"' | sudo tee /etc/locale.conf
			echo 'LC_ALL="ru_RU.UTF-8"' | sudo tee -a /etc/locale.conf

			# Apply the locale settings
			source /etc/locale.conf

			# Restart services to apply locale settings if necessary
			sudo systemctl restart systemd-logind
			sudo yum install mc -y
		
			mkdir distr
			cd distr
			wget https://repo.postgrespro.ru/1c/1c-16/keys/pgpro-repo-add.sh
		
			sh pgpro-repo-add.sh
			yum install postgrespro-1c-16 -y
			/opt/pgpro/1c-16/bin/pg-setup initdb
			/opt/pgpro/1c-16/bin/pg-setup service enable
			/opt/pgpro/1c-16/bin/pg-setup service start
		
			sudo -u postgres psql -c "ALTER USER postgres WITH PASSWORD 'postgres';"
		
		SHELL
		
	end
end


  